<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta name="generator" content="Hugo 0.44" />
  <meta charset="utf-8">
  <title>snappycat: A command line tool to decompress snappy files produced by Hadoop · City of Wings</title>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="I often encounter Snappy-compressed files recently when I am learning Spark. Although we could just use sc.textFile to read them in Spark, sometimes we might want to download them locally for processing. However, reading these files locally is complicated because the file format is not exactly Snappy-compressed files, as Hadoop stores those files in its own way.
Most of existing solutions use Java to link with Hadoop library, but the setup is rather complicated." />

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
<link rel="stylesheet" href="/css/den.css">


<meta property="og:title" content="snappycat: A command line tool to decompress snappy files produced by Hadoop" />
<meta property="og:description" content="I often encounter Snappy-compressed files recently when I am learning Spark. Although we could just use sc.textFile to read them in Spark, sometimes we might want to download them locally for processing. However, reading these files locally is complicated because the file format is not exactly Snappy-compressed files, as Hadoop stores those files in its own way.
Most of existing solutions use Java to link with Hadoop library, but the setup is rather complicated." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://city.shaform.com/en/2015/11/06/snappycat/" />



<meta property="article:published_time" content="2015-11-06T21:20:00&#43;08:00"/>

<meta property="article:modified_time" content="2015-11-06T21:20:00&#43;08:00"/>

<meta property="og:site_name" content="City of Wings" />










<meta itemprop="name" content="snappycat: A command line tool to decompress snappy files produced by Hadoop">
<meta itemprop="description" content="I often encounter Snappy-compressed files recently when I am learning Spark. Although we could just use sc.textFile to read them in Spark, sometimes we might want to download them locally for processing. However, reading these files locally is complicated because the file format is not exactly Snappy-compressed files, as Hadoop stores those files in its own way.
Most of existing solutions use Java to link with Hadoop library, but the setup is rather complicated.">


<meta itemprop="datePublished" content="2015-11-06T21:20:00&#43;08:00" />
<meta itemprop="dateModified" content="2015-11-06T21:20:00&#43;08:00" />
<meta itemprop="wordCount" content="201">



<meta itemprop="keywords" content="Hadoop,Spark,snappy,snappycat," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="snappycat: A command line tool to decompress snappy files produced by Hadoop"/>
<meta name="twitter:description" content="I often encounter Snappy-compressed files recently when I am learning Spark. Although we could just use sc.textFile to read them in Spark, sometimes we might want to download them locally for processing. However, reading these files locally is complicated because the file format is not exactly Snappy-compressed files, as Hadoop stores those files in its own way.
Most of existing solutions use Java to link with Hadoop library, but the setup is rather complicated."/>

<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-13132274-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</head>
<body>
  
  <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('/images/background.jpg'); background-position: center; background-size: cover;">
  <div class="container">
  <nav class="header-nav navbar navbar-expand-md navbar-dark light-dark">
    <div class="header-logo navbar-brand">
      <a class="float-left" href="/en/">
        
        <img class="mr20 header-logo-image" src="/images/fly.png" alt="logo">
        
        
          City of Wings
         
      </a>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="nav-menu collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        
          <li class="nav-item">
            
              <a class="nav-link" href="/en/category/ideas/">Ideas</a>
            
          </li>
        
          <li class="nav-item">
            
              <a class="nav-link" href="/en/category/notes/">Notes</a>
            
          </li>
        
          <li class="nav-item">
            
              <a class="nav-link" href="/en/category/projects/">Projects</a>
            
          </li>
        
          <li class="nav-item">
            
              <a class="nav-link" href="https://city.shaform.com/zh/" rel="noopener" target="_blank"><i class="fas fa-globe-americas"></i>繁體中文</a>
            
          </li>
        
      </ul>
    </div>
  </nav>
</div>

<div class="container header-wrapper">
  <div class="row">
    <div class="col-lg-12">
      <div class="header-content">
        <h1 class="header-title">snappycat: A command line tool to decompress snappy files produced by Hadoop</h1>
        <p class="header-date">By
          Shaform,
        
          Fri 06 November 2015, In categories
            <a href="/en/category/">Projects</a></p>
        
        <div class="header-underline"></div>
        <div class="clearfix"></div>
          <p class="float-right header-tags">
              <i class="fas fa-tags" aria-hidden="true"></i>
              <a href="/en/tag/hadoop/">Hadoop</a>, <a href="/en/tag/spark/">Spark</a>, <a href="/en/tag/snappy/">snappy</a>, <a href="/en/tag/snappycat/">snappycat</a>
          </p>
        
        

      </div>
    </div>
  </div>
</div>

  </div>
<div class="container content">
  <p>I often encounter <a href="https://blog.cloudera.com/blog/2011/09/snappy-and-hadoop/">Snappy</a>-compressed files recently when I am learning
Spark.  Although we could just use <code>sc.textFile</code> to read them in Spark,
sometimes we might want to download them locally for processing. However,
reading these files locally is complicated because the file format is not
exactly Snappy-compressed files, as Hadoop stores those files in its own way.</p>

<p>Most of existing solutions use Java to link with Hadoop library, but the setup
is rather complicated. Moreover, some tools don&rsquo;t support empty files.
Therefore, I spent some time to study the file format.</p>

<p>In short, Hadoop split the files into multiple blocks, and each block is
compressed with Snappy independently. Before each compressed block, two 32-bit
number are used to represent the decompressed size and the compressed size,
respectively.</p>

<p>As Spark split files into multiple partitions, some partitions might be empty.
In such cases, the files would only contain two 32-bit 0s.</p>

<p>I developed a short C++ program to handle these cases: <a href="https://github.com/shaform/snappycat">snappycat</a>.</p>

<p>The usage is simple, just use input files as arguments:</p>

<div class="sh-highlight"><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="hl">./snappycat DIRECTORY/*.snappy</span></code></pre></div></div>


<p>It also supports standard input:</p>

<div class="sh-highlight"><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="hl">cat DIRECTARY/*.snappy <span class="p">|</span> snappycat</span></code></pre></div></div>


<p>The program outputs the decompressed result to standard output. So to save the output, use:</p>

<div class="sh-highlight"><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="hl">./snappycat DIRECTORY/*.snappy &gt; output.txt</span></code></pre></div></div>



  
  
<div class="disqus-comment">
<div>
<div class="comment-underline"></div>
</div>
<div class="btn btn-secondary disqus-button" id="load_disqus" onclick="load_disqus()">
  Load Disqus Comments
</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
  function load_disqus() {
    
    
    if (window.location.hostname === 'localhost') return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'cityofwings';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

    $('#load_disqus').remove();
  };
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>

</div>


</div>
<div class="footer gradient-2">
  <div class="container footer-container ">
    <div class="row">
      <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
        <div class="footer-title">Sitemap</div>
        <ul class="list-unstyled">
            
              <li><a href="/en/tags/">Tags</a></li>
              <li><a href="/en/categories/">Categories</a></li>
            
            
            
              <li><a rel="alternate" type="application/rss&#43;xml" href="https://city.shaform.com/en/index.xml">RSS Feed</a></li>
            
            
        </ul>
      </div>
      <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
        
      </div>
      <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
        
        <div class="footer-title">Links</div>
        <ul class="list-unstyled">
          
          <li><a href="https://shaform.com/" rel="noopener" target="_blank">About Me</a></li>
          
          <li><a href="https://island.shaform.com/en/" rel="noopener" target="_blank">An Island</a></li>
          
        </ul>
        
      </div> 
      <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
        <p class="pull-right text-right">
          <small><em>Proudly powered by <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo</a></em></small><br/>
          <small><em>Theme - <a href="https://github.com/shaform/hugo-them-den" rel="noopener" target="_blank">Den</a></em></small><br/>
          <small>
            &copy; 
            Shaform
            
              2010 -
            2018
          </small>
          
        </p>
      </div>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
</body>
</html>
